<!DOCTYPE html>
<!-- Project Yarn Main Page -->

<html>
<head>
	<title>CiF Test</title>
	<script src="cif.js"></script>
	<script src="mia.js"></script>
	
</head>
<body>

	<h1>Hello?</h1>

	<div id="titleDiv">
		<h1>Modular Identities Architecture</h1>
	</div>
	<div id="statusDiv">
		<h3 id="statusMessage">Click Button to progress the state of the world</h3>
	</div>

	<div class = "field" onclick="move()">
		<div class = "character" id="hero">
			\O/
		</div>
		<div class = "character" id="love">
			0\
		</div>
		<div class = "character" id="rival">
			@.o
		</div>
	</div>

	<div id="actionArea">
		<h1> What to do on turn <span id="turnNumberPlace">0</span>:</h1>
		Towards Love:
		<div id="actionList_hero_love"> </div>
		Towards Yourself:
		<div id="actionList_hero_hero"></div>
		<!--Towards Rival:-->
		<div id="actionList_hero_rival"></div>
	</div>

	<div id="chatBubble"></div>

	<div id="stateArea">
		<h1>Social State</h1>
		<div id="kinshipStateDisplay">
			<h2>Kinship</h2>
			<div id="kinshipHeroToLover">Hero to Lover: <span id="kinshipHeroToLoverNumber">NA</span></div>
			<div id="kinshipLoverToHero">Lover to Hero: <span id="kinshipLoverToHeroNumber">NA</span></div>
			<div id="kinshipLoverToHero">Lover to Rival: <span id="kinshipLoverToRivalNumber">NA</span></div>
		</div>
		<div id="dutyStateDisplay">
			<h2>Duty</h2>
			<div id="dutyHeroToLover">Hero to Lover: <span id="dutyHeroToLoverNumber">NA</span></div>
			<div id="dutyLoverToHero">Lover to Hero: <span id="dutyLoverToHeroNumber">NA</span></div>
			<div id="dutyLoverToRival">Lover to Rival: <span id="dutyLoverToRivalNumber">NA</span></div>
		</div>
		<div id="Hero Attributes">
			<h2>Hero Attributes</h2>
			<div id="heroStrength">Strength: <span id="heroStrengthNumber">NA</span></div>
			<div id="heroIntelligence">Intelligence: <span id="heroIntelligenceNumber">NA</span></div>
		</div>
	</div>


	<script type="text/javascript">

		document.addEventListener('cifLoaded', function (e) {
			var loadResult = cif.init();
			console.log(loadResult);

			var rawSchema = cif.loadFile("schema.json");
			var schema = cif.loadSocialStructure(rawSchema);

			var rawCast = cif.loadFile("cast.json");
			var cast = cif.addCharacters(rawCast);

			var rawRules = cif.loadFile("triggerRules.json");
			var ids = cif.addRules(rawRules);
			console.log("ids", ids);
			ids = cif.addRules(cif.loadFile("volitionRules.json"));
			console.log("ids2", ids);

			var rawActions = cif.loadFile("actions.json");
			var actions = cif.addActions(rawActions);

			console.log("schema", schema);
			console.log("cast", cast);
			console.log("actions", actions);

			setUpInitialState();	

			var storedVolitions = cif.calculateVolition(cast);

			var aldric  = "Aldric";
			var beatrice = "Beatrice";
			var cedric = "Cedric";
			var vol = storedVolitions.getFirst(aldric , beatrice, cedric);
			console.log(vol);





			var nextTurn = function(){
				console.log("We have achieved A NEW TURN!");

				gameVariables.turnNumber += 1;
				checkForEndConditions();
				if(gameVariables.gameOver === true){
					var endMessageArea = document.getElementById("statusMessage");
					endMessageArea.innerHTML = gameVariables.endingText;
				}
				else{
					cif.setupNextTimeStep();
					cif.dumpSFDB();
					storedVolitions = cif.calculateVolition(cast);
					var aBActions = cif.getAction(aldric , beatrice, storedVolitions, cast);
					var aCActions = cif.getAction(aldric , cedric, storedVolitions, cast);
					var bAActions = cif.getAction(beatrice, aldric, storedVolitions, cast);
					var bCActions = cif.getAction(beatrice, cedric, storedVolitions, cast);
					console.log("actions")
					populateActionLists(storedVolitions, cast);
					cleanUpUIForNewTurn();
				}
			};
			console.log("Actions: ", actions);

		}, false);
	</script>

</body>
</html>